<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
    </head>
    <body>
        <h2>Comparador Sociocultural do Enem</h2>
        <p>
            É difícil relacionar os fatores socioculturais com a qualidade de
            aprendizado. Os gráficos ajudarão a ver quais unidades da federação
            estão com o melhor ensino, e quais os fatores socioculturais que
            mais influenciaram.
        </p>
        <p>Escolha o fator:</p>
        <select id="fator">
        </select>
        <button onclick="atualizarGrafico()">Atualizar Gráfico</button>
        <br/>
        <br/>
        <canvas id="myChart" width="400" height="400"></canvas>
        
        <script src="Chart.js"></script>
        <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script type="text/javascript">
            var fatores = ["fator 1","fator 2"];
            function iniciar(){
                for(i=0;i<fatores.length;i++){
                    $('#fator').append("<option value='"+(i+1)+"'>"+fatores[i]+"</option>");
                }
            }
            iniciar();
            
            function atualizarGrafico(){
                //Get the context of the canvas element we want to select
                var url = "/Comparador_Sociocultural_do_ENEM/servlet?fator="+$("#fator").find(":selected").val();
                $.ajax({
                    url: url,
                    type: "GET",
                    dataType: "json",
                    success: function(data) {
                        console.log("Data returned : " + data);

                        if (typeof data == 'object') {
                            var ctx = document.getElementById("myChart").getContext("2d");
                            new Chart(ctx).Line(data);
                        }

                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        console.log("jqXHR : "+jqXHR + " text status : " + textStatus + " error : " + errorThrown);
                    }
                });
                
            }
        </script>
    </body>
</html>
